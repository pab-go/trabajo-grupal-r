"0","# Crear una clasificación de municipios: Urbano o Rural"
"0","# Criterio: si el censo es mayor a 10,000, es Urbano; de lo contrario, es Rural"
"0","datos <- election_data |> "
"0","  mutate("
"0","    tipo_municipio = ifelse(censo > 10000, ""Urbano"", ""Rural""),"
"0","    votos_totales = votos_blancos + votos_nulos + votos_candidaturas, # Calcular total de votos"
"0","    proporción_nulos = (votos_nulos / votos_totales) * 100,          # Proporción de nulos"
"0","    proporción_blancos = (votos_blancos / votos_totales) * 100       # Proporción de blancos"
"0","  )"
"0",""
"0","# Resumen de proporciones por tipo de municipio"
"0","resumen_tipo <- datos |> "
"0","  group_by(tipo_municipio) |> "
"0","  summarise("
"0","    media_nulos = mean(proporción_nulos, na.rm = TRUE),"
"0","    media_blancos = mean(proporción_blancos, na.rm = TRUE),"
"0","    .groups = ""drop"""
"0","  )"
"0",""
"0","# Visualización de proporciones por tipo de municipio"
"0","resumen_tipo |> "
"0","  pivot_longer(cols = starts_with(""media""), names_to = ""tipo_voto"", values_to = ""proporcion"") |> "
"0","  ggplot(aes(x = tipo_municipio, y = proporcion, fill = tipo_voto)) +"
"0","  geom_col(position = ""dodge"") +"
"0","  scale_fill_manual(values = c(""media_nulos"" = ""red"", ""media_blancos"" = ""blue""),"
"0","                    labels = c(""Votos Nulos"", ""Votos en Blanco"")) +"
"0","  labs("
"0","    title = ""Proporciones de Votos Nulos y Blancos por Tipo de Municipio"","
"0","    x = ""Tipo de Municipio"","
"0","    y = ""Proporción (%)"","
"0","    fill = ""Tipo de Voto"""
"0","  ) +"
"0","  theme_minimal()"

"0",""
"0","# Seleccionar el partido ganador por municipio y clasificar por zona"
"0","election_data <- election_data |> "
"0","  mutate("
"0","    zona = if_else(censo <= 10000, ""Rural"", ""Urbana"") "
"0",""
"0","  ) "
"0",""
"0","votos_por_zona <- election_data |> summarise(votos=sum(votos), .by = c(zona,siglas))"
"0",""
"0","votos_por_zona2 <- votos_por_zona |> pivot_wider(names_from = zona, values_from = votos) |> mutate(rural=(Rural/sum(Rural))*100, urbana=(Urbana/sum(Urbana))*100, dif_perc=rural-urbana) "
"0",""
"0","#TEst de wilcoxon-MAnWhitney"
"0","wilcox.test(votos_por_zona2$rural, votos_por_zona2$urbana, paired = TRUE)"
"1","
"
"1","	Wilcoxon signed rank exact test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","votos_por_zona2$rural and votos_por_zona2$urbana"
"1",""
"1","
"
"1","V = 43, p-value = 0.791"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","location shift"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","
"
"0","#UN gráfico para ver los cambios"
"0",""
"0","barras_rural <- ggplot(votos_por_zona2) +"
"0","  geom_col(aes(x = fct_reorder(siglas, dif_perc), y= dif_perc,fill=siglas)) +  "
"0","  scale_y_continuous(limits = c(-10, 10)) +  "
"0","  scale_fill_manual(values= c(CS = ""orange"","
"0","                              UP = ""purple"", "
"0","                              VOX = ""green"","
"0","                              OTROS=""grey"","
"0","                              MP=""#009975"","
"0","                              BNG=""#6AADE4"","
"0","                              PNV=""#086522"","
"0","                              ""CONVERGÈNCIA I UNIÓ""=""#FFDFC4"","
"0","                              ERC=""yellow"","
"0","                              BILDU=""#30D5C8"","
"0","                              PSOE=""red"", "
"0","                              PP=""blue""))+"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1),"
"0","        axis.title.x = element_blank(),"
"0","        legend.position = ""none"")+"
"0","  labs(title = ""Diferencia en porcentaje en zonas rurales y urbanas y anómalos"",y=""diferencia"")"
"0",""
"0","#GRAFICO CAJAS Y BIGOTES PARA LOS ANOMALOS"
"0","bigotes_rural <-ggplot(votos_por_zona2) +"
"0","  geom_boxplot(aes(y = dif_perc, fill = ""#CDAA7D""), width = 0.4) +  # Una sola caja para toda la variable"
"0","  scale_y_continuous(limits = c(-4, 4)) +  # Ajuste de los límites del eje Y"
"0","  theme("
"0","    axis.text.x = element_blank(),  # Eliminar el eje X"
"0","    axis.ticks.x = element_blank(),  # Eliminar las marcas del eje X"
"0","    axis.title.x = element_blank(),  # Eliminar el título del eje X"
"0","    axis.line.x = element_blank(),"
"0","    axis.title.y = element_blank(),"
"0","    legend.position = ""none"","
"0","     theme("
"0","    margin = margin(20, 20, 20, 0),"
"0","    plot.title = element_markdown("
"0","      family = ""Econ Sans Cnd"", "
"0","      size = 15"
"0","    )"
"0","  )"
"0","  )"
"0"," barras_rural+bigotes_rural+ "
"0","  plot_layout(ncol = 2, widths = c(2.75, 1.25))"
"0",""
